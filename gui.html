<html>
    <head>
        <title>noobcraft</title>
        <script type="text/javascript"
            src="https://cdn.rawgit.com/brython-dev/brython/3.2.7/www/src/brython.js">
        </script>
    </head>

    <body onload="brython(1)">

        <div>
            <button>zoom in</button>
            <button>zoom out</button>
            <button id="themeChangeButton">change theme</button>
        </div>
        
        <canvas id="mycanvas">Loading... Please wait. :)</canvas>

        <script type="text/python">
            from browser import document, timer, alert

            from noobcraft.game import Game
            from noobcraft.rendering.renderer import Renderer
            from noobcraft.rendering.themes import BasicTheme, RPGTheme, RealisticTheme
            from noobcraft.actors.demo import LazyActor, RandomActor, BerserkActor

            game = Game()
            renderer = Renderer()
            themes = [BasicTheme(), RPGTheme(), RealisticTheme()]
            document.themeIndex = 2

            def drawGame(elapsedSeconds):
                canvas = document.getElementById('mycanvas')

                if canvas.getContext is None:
                    alert('You need Safari or Firefox 1.5+ to see this demo.')
                else:
                    ctx = canvas.getContext('2d')
                    ctx.canvas.width  = 800
                    ctx.canvas.height = 600
                    renderer.setCtx(ctx)
                    themes[document.themeIndex].draw(renderer, game, elapsedSeconds)

            def gameloop():
                timer.set_timeout(gameloop, 20)

                game.update()
                drawGame(0.020)

            def gameloopDebug():
                game.update()
                game.update()
                game.update()
                drawGame(20)

            def nextTheme(event):
                document.themeIndex = (document.themeIndex + 1) % len(themes)

            game.addActor(LazyActor())
            game.addActor(RandomActor())
            game.addActor(BerserkActor())

            game.start()
            gameloop();
            #gameloopDebug();

            document['themeChangeButton'].bind('click',nextTheme)
        </script>
    </body>
</html>
